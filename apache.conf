<VirtualHost *:80>
    ServerName votredomaine.com
    ServerAlias www.votredomaine.com
    Redirect permanent / https://votredomaine.com/
</VirtualHost>

<VirtualHost *:443>
    ServerName votredomaine.com
    ServerAlias www.votredomaine.com
    DocumentRoot /var/www/serviceconnect/public

    # SSL Configuration
    SSLEngine on
    SSLCertificateFile /etc/letsencrypt/live/votredomaine.com/fullchain.pem
    SSLCertificateKeyFile /etc/letsencrypt/live/votredomaine.com/privkey.pem
    SSLCertificateChainFile /etc/letsencrypt/live/votredomaine.com/chain.pem

    # Security Headers
    Header always set X-Frame-Options "SAMEORIGIN"
    Header always set X-XSS-Protection "1; mode=block"
    Header always set X-Content-Type-Options "nosniff"
    Header always set Referrer-Policy "no-referrer-when-downgrade"
    Header always set Content-Security-Policy "default-src 'self' http: https: data: blob: 'unsafe-inline'"

    # Laravel Configuration
    <Directory /var/www/serviceconnect/public>
        AllowOverride All
        Require all granted
    </Directory>

    # File Upload Limits
    LimitRequestBody 52428800

    # Logging
    ErrorLog ${APACHE_LOG_DIR}/serviceconnect_error.log
    CustomLog ${APACHE_LOG_DIR}/serviceconnect_access.log combined
</VirtualHost>
